Originally implemented by Nur Ertug and Daniel Tozodore
