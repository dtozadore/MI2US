Originally implemented by Mortadha Abderrahim and Daniel Tozodore
